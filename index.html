<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบสต็อคของชำร่วย (Vue Version)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        /* Transition for switching views */
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="app">
        <nav class="bg-white border-b border-gray-200 py-3 px-4 md:px-6 sticky top-0 z-20 shadow-sm flex flex-wrap justify-between items-center">
            <h1 class="text-lg md:text-2xl font-bold text-black truncate max-w-[50%]">
                ระบบ<span class="hidden md:inline">จัดการ</span><span class="text-red-600">ของชำร่วย</span>
            </h1>
            
            <div class="flex items-center gap-3 md:gap-6">
                <button @click="currentView = 'home'" 
                    :class="['text-sm md:text-base font-bold transition', currentView === 'home' ? 'text-black border-b-2 border-black' : 'text-gray-500 hover:text-red-600']">
                    <i class="fa-solid fa-house md:hidden"></i> <span class="hidden md:inline">หน้าหลัก</span>
                </button>
                
                <button @click="currentView = 'history'" 
                    :class="['text-sm md:text-base font-bold transition', currentView === 'history' ? 'text-black border-b-2 border-black' : 'text-gray-500 hover:text-red-600']">
                    <span class="md:hidden">ประวัติ</span> <span class="hidden md:inline">ประวัติการทำรายการ</span>
                </button>

                <div v-if="currentUser">
                    <button @click="logout" class="text-red-600 font-bold flex items-center gap-1">
                        <i class="fa-solid fa-right-from-bracket"></i> ออกจากระบบ
                    </button>
                </div>
                <div v-else>
                    <button @click="modals.login = true" class="bg-black text-white px-4 py-1.5 rounded-full text-sm flex items-center gap-1">
                        <i class="fa-solid fa-user-lock"></i> Staff Login
                    </button>
                </div>
            </div>
        </nav>

        <div class="max-w-6xl mx-auto p-6">
            
            <div v-if="currentView === 'home'">
                <div v-if="currentUser" class="mb-6 flex justify-end">
                    <button @click="modals.add = true" class="bg-black text-white px-4 py-2 rounded hover:bg-gray-800 shadow-lg flex items-center gap-2">
                        <i class="fa-solid fa-plus"></i> เพิ่มของชำร่วย
                    </button>
                </div>
                
                <div class="mb-6 flex flex-col md:flex-row justify-between items-center gap-4">
                    <h2 class="text-xl font-bold border-l-4 border-red-600 pl-3">รายการของชำร่วยทั้งหมด</h2>
                    
                    <div class="flex items-center gap-3 w-full md:w-auto">
                        <div class="flex bg-white rounded-lg shadow-sm border border-gray-200 p-1">
                            <button @click="viewMode = 'grid'" :class="viewMode === 'grid' ? 'bg-black text-white shadow' : 'text-gray-500 hover:bg-gray-100'" class="px-3 py-1.5 rounded text-sm transition"><i class="fa-solid fa-border-all"></i></button>
                            <button @click="viewMode = 'list'" :class="viewMode === 'list' ? 'bg-black text-white shadow' : 'text-gray-500 hover:bg-gray-100'" class="px-3 py-1.5 rounded text-sm transition"><i class="fa-solid fa-list"></i></button>
                        </div>

                        <div class="relative w-full md:w-64">
                            <input type="text" v-model="filters.search" placeholder="ค้นหาของชำร่วย..." class="w-full border-2 border-gray-200 p-2 pl-10 rounded-full text-sm focus:border-red-600 outline-none transition shadow-sm">
                            <span class="absolute left-3 top-2.5 text-gray-400"><i class="fa-solid fa-magnifying-glass"></i></span>
                        </div>
                    </div>
                </div>

                <div v-if="loadingItems" class="text-center py-20 text-gray-400 font-bold animate-pulse">กำลังโหลดข้อมูล...</div>

                <div v-else-if="viewMode === 'grid'" class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-6 items-stretch">
                    <div v-for="item in filteredItems" :key="item.id" class="bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-xl transition-all duration-300 flex flex-col h-full">
                        <div class="w-full aspect-[4/5] bg-gray-100 relative group overflow-hidden">
                            <img :src="item.image_url || 'https://via.placeholder.com/300'" :class="{'grayscale': item.quantity <= 0}" class="absolute inset-0 w-full h-full object-cover object-center transition-transform duration-500 group-hover:scale-110">
                            <div v-if="item.quantity <= 0" class="absolute inset-0 flex items-center justify-center bg-black/40 backdrop-blur-sm z-10">
                                <span class="bg-red-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg">สินค้าหมด</span>
                            </div>
                        </div>
                        
                        <div class="p-4 flex flex-col flex-grow">
                            <div class="mb-4">
                                <h3 class="font-bold text-lg text-gray-800 leading-tight mb-1 line-clamp-1" :title="item.name">{{ item.name }}</h3>
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-[10px] bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded font-bold border border-gray-200">
                                        ทุน: {{ item.cost_per_unit?.toLocaleString() || '-' }} บ.
                                    </span>
                                </div>
                                <p class="text-gray-500 text-xs line-clamp-2 h-8 overflow-hidden">{{ item.description || '-' }}</p>
                            </div>
                            
                            <div class="mt-auto">
                                <div class="grid grid-cols-3 gap-1">
                                    <div class="bg-blue-50 border border-blue-100 rounded p-1.5 text-center"><div class="text-[9px] text-blue-500 font-bold uppercase">รับเข้า</div><div class="text-sm font-extrabold text-blue-700">{{ item.total_quantity }}</div></div>
                                    <div class="bg-red-50 border border-red-100 rounded p-1.5 text-center"><div class="text-[9px] text-red-500 font-bold uppercase">ใช้ไป</div><div class="text-sm font-extrabold text-red-700">{{ item.total_quantity - item.quantity }}</div></div>
                                    <div class="bg-green-50 border border-green-100 rounded p-1.5 text-center"><div class="text-[9px] text-green-600 font-bold uppercase">คงเหลือ</div><div class="text-sm font-extrabold text-green-700">{{ item.quantity }}</div></div>
                                </div>
                                
                                <div v-if="currentUser" class="flex gap-1 mt-3 pt-3 border-t border-gray-100">
                                    <button @click="openAction(item, 'RESTOCK')" class="flex-1 py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-xs font-bold flex items-center justify-center gap-1 transition"><i class="fa-solid fa-plus text-green-600"></i> เติม</button>
                                    <button @click="openAction(item, 'WITHDRAW')" class="flex-1 py-1.5 bg-black hover:bg-gray-800 text-white rounded text-xs font-bold flex items-center justify-center gap-1 transition"><i class="fa-solid fa-minus"></i> เบิก</button>
                                </div>
                                <div v-if="currentUser" class="flex gap-1 mt-1">
                                    <button @click="openEditModal(item)" class="flex-1 text-yellow-600 text-[10px] border border-yellow-600 rounded py-1 flex items-center justify-center gap-1 hover:bg-yellow-50">แก้ไข</button>
                                    <button @click="deleteItem(item)" class="flex-1 text-red-500 text-[10px] border border-red-500 rounded py-1 flex items-center justify-center gap-1 hover:bg-red-50">ลบ</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-else class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm">
                            <thead class="bg-gray-100 text-gray-700 uppercase tracking-wider text-xs">
                                <tr>
                                    <th class="p-3">สินค้า</th>
                                    <th class="p-3 text-right">ต้นทุน/ชิ้น</th>
                                    <th class="p-3 text-center text-blue-700 bg-blue-50">รับเข้า</th>
                                    <th class="p-3 text-center text-red-700 bg-red-50">ใช้ไป</th>
                                    <th class="p-3 text-center text-green-700 bg-green-50">คงเหลือ</th>
                                    <th v-if="currentUser" class="p-3 text-center">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100">
                                <tr v-for="item in filteredItems" :key="item.id" class="hover:bg-gray-50 transition">
                                    <td class="p-3">
                                        <div class="flex items-center gap-3">
                                            <img :src="item.image_url || 'https://via.placeholder.com/100'" class="w-10 h-10 object-cover rounded-md border bg-gray-100">
                                            <div>
                                                <div class="font-bold text-gray-800 text-sm">{{ item.name }}</div>
                                                <div class="text-xs text-gray-500 truncate max-w-[150px]">{{ item.description || '-' }}</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="p-3 text-right font-mono text-gray-600">{{ item.cost_per_unit?.toLocaleString() || '-' }}</td>
                                    <td class="p-3 text-center font-bold text-blue-600 bg-blue-50/50">{{ item.total_quantity }}</td>
                                    <td class="p-3 text-center font-bold text-red-600 bg-red-50/50">{{ item.total_quantity - item.quantity }}</td>
                                    <td class="p-3 text-center font-bold text-green-600 bg-green-50/50 text-base">{{ item.quantity }}</td>
                                    <td v-if="currentUser" class="p-3 text-center">
                                        <div class="flex gap-1 justify-center">
                                            <button @click="openAction(item, 'WITHDRAW')" class="w-7 h-7 bg-black text-white rounded hover:bg-gray-800 flex items-center justify-center transition" title="เบิก"><i class="fa-solid fa-minus text-xs"></i></button>
                                            <button @click="openAction(item, 'RESTOCK')" class="w-7 h-7 bg-gray-200 text-black rounded hover:bg-gray-300 flex items-center justify-center transition" title="เติม"><i class="fa-solid fa-plus text-xs"></i></button>
                                            <button @click="openEditModal(item)" class="w-7 h-7 text-yellow-600 border border-yellow-600 rounded hover:bg-yellow-50 flex items-center justify-center transition" title="แก้ไข"><i class="fa-solid fa-pen text-xs"></i></button>
                                            <button @click="deleteItem(item)" class="w-7 h-7 text-red-600 border border-red-600 rounded hover:bg-red-50 flex items-center justify-center transition" title="ลบ"><i class="fa-solid fa-trash text-xs"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div v-else-if="currentView === 'history'">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold border-l-4 border-red-600 pl-3">ประวัติการทำรายการทั้งหมด</h2>
                </div>

                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="relative">
                            <label class="text-xs font-bold text-gray-500 ml-1"><i class="fa-solid fa-calendar-check text-red-600"></i> เลือกเดือน</label>
                            <select v-model="filters.logMonth" @change="loadLogs" class="w-full border-2 border-gray-100 p-2 rounded-lg text-sm outline-none focus:border-red-600">
                                <option value="">ทั้งหมดทุกเดือน</option>
                                <option value="01">มกราคม</option><option value="02">กุมภาพันธ์</option><option value="03">มีนาคม</option>
                                <option value="04">เมษายน</option><option value="05">พฤษภาคม</option><option value="06">มิถุนายน</option>
                                <option value="07">กรกฎาคม</option><option value="08">สิงหาคม</option><option value="09">กันยายน</option>
                                <option value="10">ตุลาคม</option><option value="11">พฤศจิกายน</option><option value="12">ธันวาคม</option>
                            </select>
                        </div>
                        <div class="relative">
                            <label class="text-xs font-bold text-gray-500 ml-1"><i class="fa-solid fa-box text-red-600"></i> ชื่อสินค้า</label>
                            <input type="text" v-model="filters.logItemName" @input="loadLogs" placeholder="พิมพ์ชื่อสินค้า..." class="w-full border-2 border-gray-100 p-2 rounded-lg text-sm outline-none focus:border-red-600">
                        </div>
                        <div class="relative">
                            <label class="text-xs font-bold text-gray-500 ml-1"><i class="fa-solid fa-location-dot text-red-600"></i> กรองสาขา</label>
                            <input type="text" v-model="filters.logBranch" @input="loadLogs" placeholder="พิมพ์ชื่อสาขา..." class="w-full border-2 border-gray-100 p-2 rounded-lg text-sm outline-none focus:border-red-600">
                        </div>
                        <div class="flex items-end">
                            <button @click="exportLogsToCSV" class="w-full bg-green-600 text-white py-2 rounded-lg font-bold hover:bg-green-700 transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-file-csv"></i> Export to CSV
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm">
                            <thead>
                                <tr class="bg-gray-100 text-gray-700 uppercase tracking-wider">
                                    <th class="p-3">วันที่ทำรายการ</th><th class="p-3">รายการสินค้า</th><th class="p-3 text-center">ประเภท</th>
                                    <th class="p-3">ผู้ทำรายการ</th><th class="p-3">สาขา</th><th class="p-3">กิจกรรม</th>
                                    <th class="p-3">สถานที่</th><th class="p-3">วันที่จัด</th><th class="p-3">หมายเหตุ</th>
                                    <th class="p-3 text-right">จำนวน</th><th class="p-3 text-right">คงเหลือ</th>
                                    <th class="p-3 text-right">ต้นทุน/ชิ้น</th><th class="p-3 text-right">มูลค่ารวม</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-if="loadingLogs"><td colspan="13" class="p-10 text-center text-gray-400 animate-pulse font-bold">กำลังโหลดข้อมูล...</td></tr>
                                <tr v-for="log in logs" :key="log.id" class="border-b hover:bg-gray-50 text-xs md:text-sm">
                                    <td class="p-3 text-gray-500 whitespace-nowrap">{{ formatDate(log.report_date) }}</td>
                                    <td class="p-3 font-semibold text-gray-700">{{ log.items?.name || log.item_name }}</td>
                                    <td class="p-3 text-center whitespace-nowrap" v-html="getLogBadge(log.action_type)"></td>
                                    <td class="p-3">{{ log.action_type === 'WITHDRAW' ? log.user_name : 'Admin' }}</td>
                                    <td class="p-3 text-gray-600" v-html="log.action_type === 'WITHDRAW' ? log.branch : '<span class=\'text-gray-300\'>-</span>'"></td>
                                    <td class="p-3">{{ log.action_type === 'WITHDRAW' ? (log.activity_name || '-') : '-' }}</td>
                                    <td class="p-3 text-gray-500">{{ log.action_type === 'WITHDRAW' ? (log.activity_location || '-') : '-' }}</td>
                                    <td class="p-3 text-gray-500 whitespace-nowrap">{{ log.action_type === 'WITHDRAW' ? formatDate(log.activity_date) : '-' }}</td>
                                    <td class="p-3 text-gray-400 italic">{{ log.note || '-' }}</td>
                                    <td class="p-3 text-right font-bold" :class="getAmountClass(log.action_type)">{{ getAmountPrefix(log.action_type) }}{{ log.amount }}</td>
                                    <td class="p-3 text-right font-mono font-bold text-blue-600 bg-blue-50">{{ log.balance_after ?? '-' }}</td>
                                    <td class="p-3 text-right text-gray-500 font-mono">{{ log.cost_per_unit > 0 ? log.cost_per_unit.toLocaleString() : '-' }}</td>
                                    <td class="p-3 text-right font-bold text-gray-700 font-mono">{{ (log.cost_per_unit * log.amount) > 0 ? (log.cost_per_unit * log.amount).toLocaleString() : '-' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="bg-gray-50 p-4 border-t border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4">
                        <span class="text-xs text-gray-500 font-bold">รายการที่ {{ pagination.currentPage * pagination.pageSize + 1 }} - {{ Math.min((pagination.currentPage + 1) * pagination.pageSize, pagination.totalCount) }} จากทั้งหมด {{ pagination.totalCount }}</span>
                        <div class="flex items-center gap-2">
                            <button @click="changePage(-1)" :disabled="pagination.currentPage === 0" class="w-8 h-8 flex items-center justify-center bg-white border rounded shadow-sm text-gray-400 disabled:opacity-50 hover:bg-gray-50"><i class="fa-solid fa-chevron-left"></i></button>
                            <div class="flex items-center gap-1 bg-white border rounded px-2 py-1 shadow-sm">
                                <span class="text-xs text-gray-400">หน้า</span>
                                <input type="number" :value="pagination.currentPage + 1" @change="jumpToPage($event.target.value)" class="w-12 text-center text-sm font-bold text-gray-700 outline-none focus:text-red-600">
                                <span class="text-xs text-gray-400">/ {{ pagination.totalPages }}</span>
                            </div>
                            <button @click="changePage(1)" :disabled="(pagination.currentPage + 1) >= pagination.totalPages" class="w-8 h-8 flex items-center justify-center bg-white border rounded shadow-sm text-gray-400 disabled:opacity-50 hover:bg-gray-50"><i class="fa-solid fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="modals.login" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                <div class="bg-white p-6 rounded-lg w-80 shadow-2xl">
                    <h2 class="text-xl font-bold mb-4">เข้าสู่ระบบแอดมิน</h2>
                    <input type="email" v-model="forms.login.email" placeholder="Email" class="w-full border p-2 mb-2 rounded">
                    <input type="password" v-model="forms.login.password" placeholder="Password" class="w-full border p-2 mb-4 rounded">
                    <div class="flex justify-end gap-2">
                        <button @click="modals.login = false" class="text-gray-500 text-sm">ยกเลิก</button>
                        <button @click="handleLogin" class="bg-black text-white px-4 py-2 rounded">เข้าสู่ระบบ</button>
                    </div>
                </div>
            </div>

            <div v-if="modals.add" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                <div class="bg-white p-6 rounded-lg w-96 shadow-2xl">
                    <h2 class="text-xl font-bold mb-4">เพิ่มของใหม่</h2>
                    <div class="space-y-3">
                        <input type="text" v-model="forms.add.name" placeholder="ชื่อของชำร่วย" class="w-full border p-2 rounded">
                        <input type="text" v-model="forms.add.desc" placeholder="คำอธิบาย" class="w-full border p-2 rounded">
                        <input type="number" v-model="forms.add.qty" placeholder="จำนวนเริ่มต้น" class="w-full border p-2 rounded">
                        <input type="number" v-model="forms.add.cost" placeholder="ต้นทุนต่อชิ้น (บาท)" class="w-full border p-2 rounded">
                        <div class="text-sm">รูปภาพ: <input type="file" @change="(e) => forms.add.file = e.target.files[0]" class="mt-1"></div>
                    </div>
                    <div class="flex justify-end gap-2 mt-6">
                        <button @click="modals.add = false" class="text-gray-500">ยกเลิก</button>
                        <button @click="addItem" class="bg-black text-white px-4 py-2 rounded">บันทึก</button>
                    </div>
                </div>
            </div>

            <div v-if="modals.edit" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                <div class="bg-white p-6 rounded-lg w-96 shadow-2xl border-t-4 border-yellow-500">
                    <h2 class="text-xl font-bold mb-4 text-yellow-600">แก้ไขข้อมูล</h2>
                    <div class="space-y-3">
                        <input type="text" v-model="forms.edit.name" placeholder="ชื่อสินค้า" class="w-full border p-2 rounded">
                        <input type="text" v-model="forms.edit.desc" placeholder="คำอธิบาย" class="w-full border p-2 rounded">
                        <input type="number" v-model="forms.edit.cost" placeholder="ต้นทุนต่อชิ้น (บาท)" class="w-full border p-2 rounded">
                        <div class="text-sm">เปลี่ยนรูป: <input type="file" @change="(e) => forms.edit.file = e.target.files[0]" class="mt-1"></div>
                    </div>
                    <div class="flex justify-end gap-2 mt-6">
                        <button @click="modals.edit = false" class="text-gray-500">ยกเลิก</button>
                        <button @click="submitEdit" class="bg-yellow-500 text-white px-4 py-2 rounded">บันทึก</button>
                    </div>
                </div>
            </div>

            <div v-if="modals.action" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                <div class="bg-white p-6 rounded-lg w-96 shadow-2xl max-h-[90vh] overflow-y-auto">
                    <h2 class="text-xl font-bold mb-4 text-red-600">{{ forms.action.type === 'RESTOCK' ? 'เติมสต็อค' : 'เบิกของ' }} - {{ forms.action.itemName }}</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="text-xs text-gray-500 font-bold">วันที่ทำรายการจริง</label>
                            <input type="date" v-model="forms.action.date" :readonly="forms.action.type === 'WITHDRAW'" :class="{'bg-gray-100 text-gray-500 cursor-not-allowed': forms.action.type === 'WITHDRAW'}" class="w-full border p-2 rounded text-sm">
                        </div>
                        <div>
                            <label class="text-xs text-gray-500 font-bold">จำนวน (ชิ้น)</label>
                            <input type="number" v-model="forms.action.amount" placeholder="ใส่ตัวเลขจำนวน" class="w-full border p-2 rounded text-sm">
                        </div>
                        
                        <div v-if="forms.action.type === 'WITHDRAW'" class="space-y-3 border-t pt-3 mt-3">
                            <input type="text" v-model="forms.action.userName" placeholder="ชื่อคนเบิก" class="w-full border p-2 rounded text-sm">
                            <div class="relative">
                                <select v-model="forms.action.branch" class="w-full border p-2 rounded text-sm appearance-none bg-white">
                                    <option value="" disabled>-- เลือกสาขา --</option>
                                    <option value="บ้านดู่">บ้านดู่</option><option value="พาน">พาน</option>
                                    <option value="แม่สาย">แม่สาย</option><option value="แม่จัน">แม่จัน</option>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"><i class="fa-solid fa-chevron-down text-xs"></i></div>
                            </div>
                            <input type="text" v-model="forms.action.actName" placeholder="ชื่อกิจกรรม" class="w-full border p-2 rounded text-sm">
                            <input type="text" v-model="forms.action.actLoc" placeholder="สถานที่จัดกิจกรรม" class="w-full border p-2 rounded text-sm">
                            <div>
                                <label class="text-xs text-gray-500 font-bold">วันที่จัดกิจกรรม</label>
                                <input type="date" v-model="forms.action.actDate" class="w-full border p-2 rounded text-sm">
                            </div>
                        </div>

                        <div class="pt-2">
                            <label class="text-xs text-gray-500 font-bold">หมายเหตุ (เลขที่ใบเสร็จ / รายละเอียด)</label>
                            <input type="text" v-model="forms.action.note" placeholder="ระบุหมายเหตุ..." class="w-full border p-2 rounded text-sm">
                        </div>

                        <div class="flex justify-end gap-2 mt-6">
                            <button @click="modals.action = false" class="text-gray-500">ยกเลิก</button>
                            <button @click="submitAction" class="bg-red-600 text-white px-6 py-2 rounded font-bold">ยืนยัน</button>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="modals.confirm" class="fixed inset-0 bg-black/50 flex items-center justify-center z-[110]">
                <div class="bg-white p-8 rounded-2xl w-96 shadow-2xl text-center transform scale-95 transition-all">
                    <i class="fa-solid fa-circle-question text-6xl text-yellow-500 mb-4"></i>
                    <h2 class="text-2xl font-bold mb-2">ยืนยันการลบ?</h2>
                    <p class="text-gray-500 mb-6 text-lg">{{ confirmMessage }}</p>
                    <div class="flex gap-3 justify-center">
                        <button @click="modals.confirm = false" class="px-6 py-2 bg-gray-200 rounded-lg font-bold text-gray-700">ยกเลิก</button>
                        <button @click="confirmAction" class="px-6 py-2 bg-red-600 text-white rounded-lg font-bold hover:bg-red-700">ยืนยันลบ</button>
                    </div>
                </div>
            </div>

        </div>

        <div class="fixed inset-0 flex flex-col items-center justify-center z-[100] pointer-events-none gap-4">
            <div v-for="toast in toasts" :key="toast.id" :class="toast.bgClass" class="text-white px-10 py-6 rounded-2xl shadow-2xl flex flex-col items-center gap-4 transform transition-all duration-300 pointer-events-auto min-w-[300px] border-4 border-white/20">
                <i :class="['fa-solid text-6xl', toast.icon]"></i>
                <span class="text-2xl font-bold text-center">{{ toast.message }}</span>
            </div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>